import{_ as B,r as o,o as T,e as b,a as N,g as S,x as i,y as e,z as s,E as I,B as m,J as y,A as V,U as E,C as k,v as n}from"./DfH0JLgj.js";import{s as z}from"./6mDH4Qw6.js";import{c as D}from"./BxKCmZ95.js";const G={class:"chart-container-transparent"},H={key:0,class:"error-message"},R={key:1},U={key:0,class:"countdown-message"},$={key:2},J={class:"highlight"},M=["src"],W={class:"highlight"},j={class:"highlight"},q={__name:"top-summary",setup(F){const v=o({}),d=o({}),f=o(""),c=o(3),u=o(!1),g=o(!1),_=o(!1),p=o(null),h=o(null);let r;T(()=>{r=D.create(h.value,{resize:!0,useWorker:!0}),w()}),b(()=>{r&&r.reset()});const{$axios:C}=N(),w=async()=>{try{_.value=!0;const a=localStorage.getItem("spotify_access_token");if(!a)throw new Error("No Spotify token found.");const t={Authorization:`Bearer ${a}`},l=await C.get("/wrapped/",{headers:t});v.value=l.data.top_artist,d.value=l.data.top_track,f.value=l.data.top_genre}catch(a){p.value="Error fetching highlights data.",console.error(a)}finally{_.value=!1}},x=()=>{u.value=!0;let a=c.value;const t=z(()=>{a--,c.value=a,a===0&&(clearInterval(t),u.value=!1,g.value=!0,A())},1e3)},A=()=>{r&&r({angle:90,spread:45,startVelocity:45,particleCount:100,origin:{x:.5,y:.5}})};return(a,t)=>{const l=S("v-btn");return n(),i("div",G,[e("canvas",{ref_key:"confettiCanvas",ref:h,class:"confetti-canvas"},null,512),p.value?(n(),i("div",H,s(p.value),1)):g.value?(n(),i("div",$,[e("div",J,[t[1]||(t[1]=e("h3",null,"Top Artist",-1)),e("img",{src:v.value.image,alt:"Top Artist",class:"highlight-image"},null,8,M),e("p",null,s(v.value.name),1)]),e("div",W,[t[2]||(t[2]=e("h3",null,"Top Song",-1)),e("p",null,[e("strong",null,s(d.value.title),1),k(" by "+s(d.value.artist),1)])]),e("div",j,[t[3]||(t[3]=e("h3",null,"Top Genre",-1)),e("p",null,s(f.value),1)])])):(n(),i("div",R,[u.value?y("",!0):(n(),I(l,{key:0,color:"primary",onClick:x,class:"reveal-button"},{default:m(()=>t[0]||(t[0]=[k(" Reveal Highlights ")])),_:1})),V(E,{name:"fade"},{default:m(()=>[u.value&&c.value>0?(n(),i("h3",U,s(c.value),1)):y("",!0)]),_:1})]))])}}},P=B(q,[["__scopeId","data-v-08e30b1b"]]);export{P as default};
