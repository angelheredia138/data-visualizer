import{S as ft,a as $t,r as vt,s as N}from"./CQEiDZtN.js";import{_ as _t,r as X,a as xt,o as Mt,e as At,x as D,J as Rt,z as dt,y as wt,v as G}from"./C69F-6un.js";import{o as bt}from"./CmKTTxBW.js";import{c as kt}from"./Du6F06X2.js";import"./Gi6I4Gst.js";function Tt(n){return typeof n=="string"?new ft([document.querySelectorAll(n)],[document.documentElement]):new ft([$t(n)],vt)}const lt=Math.PI,ut=2*lt,O=1e-6,St=ut-O;function mt(n){this._+=n[0];for(let t=1,r=n.length;t<r;++t)this._+=arguments[t]+n[t]}function Ct(n){let t=Math.floor(n);if(!(t>=0))throw new Error(`invalid digits: ${n}`);if(t>15)return mt;const r=10**t;return function(a){this._+=a[0];for(let l=1,h=a.length;l<h;++l)this._+=Math.round(arguments[l]*r)/r+a[l]}}class Et{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?mt:Ct(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,a,l){this._append`Q${+t},${+r},${this._x1=+a},${this._y1=+l}`}bezierCurveTo(t,r,a,l,h,f){this._append`C${+t},${+r},${+a},${+l},${this._x1=+h},${this._y1=+f}`}arcTo(t,r,a,l,h){if(t=+t,r=+r,a=+a,l=+l,h=+h,h<0)throw new Error(`negative radius: ${h}`);let f=this._x1,e=this._y1,p=a-t,o=l-r,s=f-t,d=e-r,i=s*s+d*d;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(i>O)if(!(Math.abs(d*p-o*s)>O)||!h)this._append`L${this._x1=t},${this._y1=r}`;else{let c=a-f,y=l-e,v=p*p+o*o,b=c*c+y*y,g=Math.sqrt(v),M=Math.sqrt(i),A=h*Math.tan((lt-Math.acos((v+i-b)/(2*g*M)))/2),_=A/M,x=A/g;Math.abs(_-1)>O&&this._append`L${t+_*s},${r+_*d}`,this._append`A${h},${h},0,0,${+(d*c>s*y)},${this._x1=t+x*p},${this._y1=r+x*o}`}}arc(t,r,a,l,h,f){if(t=+t,r=+r,a=+a,f=!!f,a<0)throw new Error(`negative radius: ${a}`);let e=a*Math.cos(l),p=a*Math.sin(l),o=t+e,s=r+p,d=1^f,i=f?l-h:h-l;this._x1===null?this._append`M${o},${s}`:(Math.abs(this._x1-o)>O||Math.abs(this._y1-s)>O)&&this._append`L${o},${s}`,a&&(i<0&&(i=i%ut+ut),i>St?this._append`A${a},${a},0,1,${d},${t-e},${r-p}A${a},${a},0,1,${d},${this._x1=o},${this._y1=s}`:i>O&&this._append`A${a},${a},0,${+(i>=lt)},${d},${this._x1=t+a*Math.cos(h)},${this._y1=r+a*Math.sin(h)}`)}rect(t,r,a,l){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${a=+a}v${+l}h${-a}Z`}toString(){return this._}}function T(n){return function(){return n}}const pt=Math.abs,k=Math.atan2,L=Math.cos,Pt=Math.max,ot=Math.min,I=Math.sin,j=Math.sqrt,C=1e-12,H=Math.PI,tt=H/2,K=2*H;function zt(n){return n>1?0:n<-1?H:Math.acos(n)}function gt(n){return n>=1?tt:n<=-1?-tt:Math.asin(n)}function It(n){let t=3;return n.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const a=Math.floor(r);if(!(a>=0))throw new RangeError(`invalid digits: ${r}`);t=a}return n},()=>new Et(t)}function qt(n){return n.innerRadius}function Bt(n){return n.outerRadius}function Nt(n){return n.startAngle}function Lt(n){return n.endAngle}function Ot(n){return n&&n.padAngle}function Vt(n,t,r,a,l,h,f,e){var p=r-n,o=a-t,s=f-l,d=e-h,i=d*p-s*o;if(!(i*i<C))return i=(s*(t-h)-d*(n-l))/i,[n+i*p,t+i*o]}function F(n,t,r,a,l,h,f){var e=n-r,p=t-a,o=(f?h:-h)/j(e*e+p*p),s=o*p,d=-o*e,i=n+s,c=t+d,y=r+s,v=a+d,b=(i+y)/2,g=(c+v)/2,M=y-i,A=v-c,_=M*M+A*A,x=l-h,w=i*v-y*c,S=(A<0?-1:1)*j(Pt(0,x*x*_-w*w)),E=(w*A-M*S)/_,$=(-w*M-A*S)/_,R=(w*A+M*S)/_,P=(-w*M+A*S)/_,z=E-b,u=$-g,m=R-b,B=P-g;return z*z+u*u>m*m+B*B&&(E=R,$=P),{cx:E,cy:$,x01:-s,y01:-d,x11:E*(l/x-1),y11:$*(l/x-1)}}function yt(){var n=qt,t=Bt,r=T(0),a=null,l=Nt,h=Lt,f=Ot,e=null,p=It(o);function o(){var s,d,i=+n.apply(this,arguments),c=+t.apply(this,arguments),y=l.apply(this,arguments)-tt,v=h.apply(this,arguments)-tt,b=pt(v-y),g=v>y;if(e||(e=s=p()),c<i&&(d=c,c=i,i=d),!(c>C))e.moveTo(0,0);else if(b>K-C)e.moveTo(c*L(y),c*I(y)),e.arc(0,0,c,y,v,!g),i>C&&(e.moveTo(i*L(v),i*I(v)),e.arc(0,0,i,v,y,g));else{var M=y,A=v,_=y,x=v,w=b,S=b,E=f.apply(this,arguments)/2,$=E>C&&(a?+a.apply(this,arguments):j(i*i+c*c)),R=ot(pt(c-i)/2,+r.apply(this,arguments)),P=R,z=R,u,m;if($>C){var B=gt($/i*I(E)),Z=gt($/c*I(E));(w-=B*2)>C?(B*=g?1:-1,_+=B,x-=B):(w=0,_=x=(y+v)/2),(S-=Z*2)>C?(Z*=g?1:-1,M+=Z,A-=Z):(S=0,M=A=(y+v)/2)}var V=c*L(M),Y=c*I(M),J=i*L(x),Q=i*I(x);if(R>C){var U=c*L(A),W=c*I(A),et=i*L(_),nt=i*I(_),q;if(b<H)if(q=Vt(V,Y,et,nt,U,W,J,Q)){var st=V-q[0],it=Y-q[1],at=U-q[0],rt=W-q[1],ct=1/I(zt((st*at+it*rt)/(j(st*st+it*it)*j(at*at+rt*rt)))/2),ht=j(q[0]*q[0]+q[1]*q[1]);P=ot(R,(i-ht)/(ct-1)),z=ot(R,(c-ht)/(ct+1))}else P=z=0}S>C?z>C?(u=F(et,nt,V,Y,c,z,g),m=F(U,W,J,Q,c,z,g),e.moveTo(u.cx+u.x01,u.cy+u.y01),z<R?e.arc(u.cx,u.cy,z,k(u.y01,u.x01),k(m.y01,m.x01),!g):(e.arc(u.cx,u.cy,z,k(u.y01,u.x01),k(u.y11,u.x11),!g),e.arc(0,0,c,k(u.cy+u.y11,u.cx+u.x11),k(m.cy+m.y11,m.cx+m.x11),!g),e.arc(m.cx,m.cy,z,k(m.y11,m.x11),k(m.y01,m.x01),!g))):(e.moveTo(V,Y),e.arc(0,0,c,M,A,!g)):e.moveTo(V,Y),!(i>C)||!(w>C)?e.lineTo(J,Q):P>C?(u=F(J,Q,U,W,i,-P,g),m=F(V,Y,et,nt,i,-P,g),e.lineTo(u.cx+u.x01,u.cy+u.y01),P<R?e.arc(u.cx,u.cy,P,k(u.y01,u.x01),k(m.y01,m.x01),!g):(e.arc(u.cx,u.cy,P,k(u.y01,u.x01),k(u.y11,u.x11),!g),e.arc(0,0,i,k(u.cy+u.y11,u.cx+u.x11),k(m.cy+m.y11,m.cx+m.x11),g),e.arc(m.cx,m.cy,P,k(m.y11,m.x11),k(m.y01,m.x01),!g))):e.arc(0,0,i,x,_,g)}if(e.closePath(),s)return e=null,s+""||null}return o.centroid=function(){var s=(+n.apply(this,arguments)+ +t.apply(this,arguments))/2,d=(+l.apply(this,arguments)+ +h.apply(this,arguments))/2-H/2;return[L(d)*s,I(d)*s]},o.innerRadius=function(s){return arguments.length?(n=typeof s=="function"?s:T(+s),o):n},o.outerRadius=function(s){return arguments.length?(t=typeof s=="function"?s:T(+s),o):t},o.cornerRadius=function(s){return arguments.length?(r=typeof s=="function"?s:T(+s),o):r},o.padRadius=function(s){return arguments.length?(a=s==null?null:typeof s=="function"?s:T(+s),o):a},o.startAngle=function(s){return arguments.length?(l=typeof s=="function"?s:T(+s),o):l},o.endAngle=function(s){return arguments.length?(h=typeof s=="function"?s:T(+s),o):h},o.padAngle=function(s){return arguments.length?(f=typeof s=="function"?s:T(+s),o):f},o.context=function(s){return arguments.length?(e=s??null,o):e},o}function Yt(n){return typeof n=="object"&&"length"in n?n:Array.from(n)}function Xt(n,t){return t<n?-1:t>n?1:t>=n?0:NaN}function jt(n){return n}function Dt(){var n=jt,t=Xt,r=null,a=T(0),l=T(K),h=T(0);function f(e){var p,o=(e=Yt(e)).length,s,d,i=0,c=new Array(o),y=new Array(o),v=+a.apply(this,arguments),b=Math.min(K,Math.max(-K,l.apply(this,arguments)-v)),g,M=Math.min(Math.abs(b)/o,h.apply(this,arguments)),A=M*(b<0?-1:1),_;for(p=0;p<o;++p)(_=y[c[p]=p]=+n(e[p],p,e))>0&&(i+=_);for(t!=null?c.sort(function(x,w){return t(y[x],y[w])}):r!=null&&c.sort(function(x,w){return r(e[x],e[w])}),p=0,d=i?(b-o*A)/i:0;p<o;++p,v=g)s=c[p],_=y[s],g=v+(_>0?_*d:0)+A,y[s]={data:e[s],index:p,value:_,startAngle:v,endAngle:g,padAngle:M};return y}return f.value=function(e){return arguments.length?(n=typeof e=="function"?e:T(+e),f):n},f.sortValues=function(e){return arguments.length?(t=e,r=null,f):t},f.sort=function(e){return arguments.length?(r=e,t=null,f):r},f.startAngle=function(e){return arguments.length?(a=typeof e=="function"?e:T(+e),f):a},f.endAngle=function(e){return arguments.length?(l=typeof e=="function"?e:T(+e),f):l},f.padAngle=function(e){return arguments.length?(h=typeof e=="function"?e:T(+e),f):h},f}const Gt={class:"chart-container"},Ht={key:0,class:"loading-spinner"},Zt={key:1,class:"error-message"},Jt={key:2},Qt={class:"genre-info"},Ut={__name:"pie-chart",setup(n){const t=X([]);X(null);const r=X(""),a=X(!1),l=X(null),h=X(null);let f;const{$axios:e}=xt(),p=async()=>{try{a.value=!0,l.value=null;const d=localStorage.getItem("spotify_access_token");if(!d){l.value="No Spotify token provided.",a.value=!1;return}const i={Authorization:`Bearer ${d}`},c=await e.get("/genres/",{headers:i});t.value=c.data.genres||[],o(t.value)}catch(d){l.value="Error fetching data.",console.error(d)}finally{a.value=!1}},o=d=>{const i=N(h.value);i.selectAll("*").remove();const c=i.node().clientWidth,y=i.node().clientHeight,v=Math.min(c,y)/2;i.attr("viewBox",`0 0 ${c} ${y}`).attr("preserveAspectRatio","xMidYMid meet").style("width","100%").style("height","100%");const b=i.append("g").attr("transform",`translate(${c/2},${y/2})`),g=bt(kt),M=d.sort(($,R)=>R.count-$.count).slice(0,10),_=Dt().value($=>$.count)(M),x=yt().innerRadius(0).outerRadius(v),w=yt().innerRadius(0).outerRadius(v+10),S=N("body").append("div").attr("class","tooltip").style("position","absolute").style("background","#fff").style("border","1px solid #ccc").style("padding","10px").style("border-radius","5px").style("pointer-events","none").style("display","none"),E=window.matchMedia("(hover: hover)").matches;b.selectAll("path").data(_).enter().append("path").attr("d",x).attr("fill",$=>g($.data.genre)).attr("stroke","white").style("stroke-width","2px").on("mouseover",function($,R){E&&(N(this).transition().duration(200).attr("d",w),S.style("display","block").html(`${R.data.genre} - Artists: ${R.data.count}`).style("top",`${$.pageY-10}px`).style("left",`${$.pageX+10}px`))}).on("mousemove",function($){E&&S.style("top",`${$.pageY-10}px`).style("left",`${$.pageX+10}px`)}).on("mouseout",function(){E&&(N(this).transition().duration(200).attr("d",x),S.style("display","none"))}).on("click",function($,R){E||(N(this).classed("selected")?(N(this).classed("selected",!1).transition().duration(200).attr("d",x),S.style("display","none")):(Tt("path").classed("selected",!1),N(this).classed("selected",!0).transition().duration(200).attr("d",w),S.style("display","block").html(`${R.data.genre} - Artists: ${R.data.count}`).style("top",`${$.pageY-10}px`).style("left",`${$.pageX+10}px`)))}),b.selectAll("text").data(_).enter().append("text").text($=>$.data.genre).attr("transform",$=>`translate(${x.centroid($)})`).style("text-anchor","middle").style("font-size","14px").style("font-family","Inter").style("fill","#000").style("font-weight","bold")},s=()=>{t.value.length>0&&o(t.value)};return Mt(()=>{p(),f=new ResizeObserver(s),f.observe(h.value)}),At(()=>{f&&f.disconnect()}),(d,i)=>(G(),D("div",Gt,[a.value?(G(),D("div",Ht,"Loading...")):Rt("",!0),l.value?(G(),D("div",Zt,dt(l.value),1)):(G(),D("div",Jt,[wt("p",Qt,dt(r.value),1),(G(),D("svg",{id:"d3-pie-chart",ref_key:"pieChartRef",ref:h},null,512))]))]))}},ne=_t(Ut,[["__scopeId","data-v-599f607d"]]);export{ne as default};
