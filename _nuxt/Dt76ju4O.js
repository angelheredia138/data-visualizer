import{_ as b,r as s,o as G,e as $,a as B,g as P,x as o,y as n,z as a,E as U,B as q,J as _,A as Y,U as L,Q as O,O as V,v as r,C as z}from"./D0YC6FMM.js";import{s as A}from"./C8Cd6dlY.js";import{c as H}from"./BxKCmZ95.js";const D={class:"chart-container-transparent"},M={key:0,class:"error-message"},W={key:1},F={key:0,class:"countdown-message"},J={key:2},Q={class:"songs-list"},j=["src"],K={class:"summary-section"},X={class:"summary-section"},Z={class:"summary-section"},ee={key:3,class:"now-playing-card"},te=["src"],ne={__name:"summary",setup(se){const p=s([]),l=s(null),v=s({uniqueGenres:null,uniqueArtists:null,trends:null}),g=s(3),m=s(!1),h=s(!1),w=s(!1),f=s(null),k=s(null);let u;G(()=>{u=H.create(k.value,{resize:!0,useWorker:!0}),x(),I()}),$(()=>{u&&u.reset()});const{$axios:i}=B(),x=async()=>{try{w.value=!0;const e=localStorage.getItem("spotify_access_token");if(!e)throw new Error("No Spotify token found.");const t={Authorization:`Bearer ${e}`},c=await i.get("/last_three_songs",{headers:t});p.value=c.data.lastThreeSongs;const d=await i.get("/now_playing",{headers:t});l.value=d.data.nowPlaying;const[y,R,E]=await Promise.all([i.get("/unique_genres",{headers:t}),i.get("/unique_artists",{headers:t}),i.get("/trends_insights",{headers:t})]);v.value={uniqueGenres:y.data.unique_genres,uniqueArtists:R.data.unique_artists,trends:E.data.trends}}catch(e){f.value="Error fetching listening data.",console.error(e)}finally{w.value=!1}},I=()=>{A(async()=>{try{const e=localStorage.getItem("spotify_access_token");if(!e)return;const t={Authorization:`Bearer ${e}`},c=await i.get("/now_playing",{headers:t});l.value=c.data.nowPlaying}catch(e){console.error("Error polling now playing:",e)}},5e3)},S=e=>e?e>50?`You've explored over ${e} unique genres. You're musically adventurous!`:e>20?`${e} unique genres—quite diverse!`:`${e} genres. You know what you like!`:"Unveiling the genres you've explored...",T=e=>e?e>200?`Incredible! ${e} artists made it to your playlist last month.`:e>100?`${e} artists—a wide range of favorites!`:`${e} artists. You prefer quality over quantity.`:"Compiling a list of your favorite artists...",C=()=>{m.value=!0;let e=g.value;const t=A(()=>{e--,g.value=e,e===0&&(clearInterval(t),m.value=!1,h.value=!0,N())},1e3)},N=()=>{u&&u({angle:90,spread:45,startVelocity:45,particleCount:100,origin:{x:.5,y:.5}})};return(e,t)=>{const c=P("v-btn");return r(),o("div",D,[n("canvas",{ref_key:"confettiCanvas",ref:k,class:"confetti-canvas"},null,512),f.value?(r(),o("div",M,a(f.value),1)):h.value?(r(),o("div",J,[n("div",Q,[t[1]||(t[1]=n("h3",null,"Your Last Three Songs",-1)),(r(!0),o(O,null,V(p.value,(d,y)=>(r(),o("div",{key:y,class:"song-card"},[n("img",{src:d.albumImage,alt:"Album Art",class:"artist-image"},null,8,j),n("div",null,[n("h3",null,a(d.name),1),n("p",null,a(d.artist),1)])]))),128))]),n("div",K,[t[2]||(t[2]=n("h3",null,"Listening Trends",-1)),n("p",null,a(v.value.trends),1)]),n("div",X,[t[3]||(t[3]=n("h3",null,"Unique Genres",-1)),n("p",null,a(S(v.value.uniqueGenres)),1)]),n("div",Z,[t[4]||(t[4]=n("h3",null,"Unique Artists",-1)),n("p",null,a(T(v.value.uniqueArtists)),1)])])):(r(),o("div",W,[m.value?_("",!0):(r(),U(c,{key:0,color:"primary",onClick:C,class:"reveal-button"},{default:q(()=>t[0]||(t[0]=[z(" Reveal Summary ")])),_:1})),Y(L,{name:"fade"},{default:q(()=>[m.value&&g.value>0?(r(),o("h3",F,a(g.value),1)):_("",!0)]),_:1})])),l.value?(r(),o("div",ee,[t[5]||(t[5]=n("h3",null,"YOU'RE LISTENING TO MUSIC RIGHT NOW!",-1)),t[6]||(t[6]=n("p",null,"HERE'S THE SONG:",-1)),n("img",{src:l.value.albumImage,alt:"Album Art",class:"artist-image"},null,8,te),n("h3",null,a(l.value.name),1),n("p",null,a(l.value.artist),1)])):_("",!0)])}}},le=b(ne,[["__scopeId","data-v-e6058bd9"]]);export{le as default};
